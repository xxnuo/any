# .any æ–‡ä»¶æ ¼å¼åŸå‹

åŸºäº WebAssembly çš„è‡ªè§£é‡Šæ–‡ä»¶æ ¼å¼åŸå‹å®ç°ã€‚

## æ¦‚è¿°

`.any` æ˜¯ä¸€ç§æ–°å‹æ–‡ä»¶æ ¼å¼ï¼Œå®ƒå°†æ•°æ®å’Œ WebAssembly è§£é‡Šå™¨æ‰“åŒ…åœ¨ä¸€èµ·ï¼Œå®ç°æ–‡ä»¶çš„è‡ªæˆ‘è§£é‡Šå’Œæå–ã€‚ç±»ä¼¼äºè‡ªè§£å‹æ–‡ä»¶ï¼Œä½†é€šè¿‡ WebAssembly æ²™ç®±æä¾›æ›´é«˜çš„å®‰å…¨æ€§ã€‚

## ç‰¹æ€§

- ğŸ“¦ **è‡ªåŒ…å«**: æ–‡ä»¶åŒ…å«æ•°æ®å’Œè§£é‡Šé€»è¾‘
- ğŸ”’ **å®‰å…¨**: åŸºäº WebAssembly æ²™ç®±æ‰§è¡Œ
- ğŸ¯ **ç®€å•**: ç»Ÿä¸€çš„æ–‡ä»¶æ ¼å¼ï¼Œæ— éœ€å„ç§è§£å‹å·¥å…·
- ğŸ” **å¯æ£€æŸ¥**: å¯ä»¥æŸ¥çœ‹æ–‡ä»¶ä¿¡æ¯è€Œä¸æ‰§è¡Œ

## æ–‡ä»¶æ ¼å¼

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   æ–‡ä»¶å¤´ (36 B)  â”‚  Magic: 0x414E5946 ("ANYF")
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  Version, å„éƒ¨åˆ†å¤§å°
â”‚   WASM æ¨¡å—      â”‚  WebAssembly è§£é‡Šå™¨
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚   æ•°æ®åŒº         â”‚  å®é™…æ–‡ä»¶å†…å®¹
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚   å…ƒæ•°æ® (JSON)  â”‚  æ–‡ä»¶ä¿¡æ¯ã€å±æ€§ç­‰
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## å®‰è£…

```bash
# è¿›å…¥åŸå‹ç›®å½•
cd prototype

# å®‰è£…ä¾èµ–ï¼ˆä½¿ç”¨ uvï¼‰
uv sync
```

## ä½¿ç”¨æ–¹æ³•

### 1. åˆ›å»º .any æ–‡ä»¶

```bash
# å‡†å¤‡ WASM æ¨¡å—
uv run python build_wasm.py

# åˆ›å»º .any æ–‡ä»¶
uv run python main.py create <æ•°æ®æ–‡ä»¶> <WASMæ¨¡å—> -o <è¾“å‡º.any> [é€‰é¡¹]

# ç¤ºä¾‹
uv run python main.py create examples/test_data.txt examples/simple.wasm \
    -o examples/test.any \
    -n "Test File" \
    -d "A test .any file"
```

**å‚æ•°è¯´æ˜:**
- `æ•°æ®æ–‡ä»¶`: è¦æ‰“åŒ…çš„åŸå§‹æ–‡ä»¶
- `WASMæ¨¡å—`: WebAssembly è§£é‡Šå™¨æ¨¡å—
- `-o, --output`: è¾“å‡ºçš„ .any æ–‡ä»¶è·¯å¾„
- `-n, --name`: æ–‡ä»¶åç§°ï¼ˆå¯é€‰ï¼‰
- `-d, --description`: æ–‡ä»¶æè¿°ï¼ˆå¯é€‰ï¼‰

### 2. æŸ¥çœ‹ .any æ–‡ä»¶ä¿¡æ¯

```bash
uv run python main.py info <æ–‡ä»¶.any>

# ç¤ºä¾‹è¾“å‡º
File: examples/test.any
Version: 1.0
Total Size: 402 bytes

Components:
  WASM Module: 34 bytes
  Data: 216 bytes
  Metadata: 116 bytes

Metadata:
{
  "name": "Test File",
  "description": "A test .any file",
  "original_filename": "test_data.txt",
  "original_size": 216
}
```

### 3. æå– .any æ–‡ä»¶å†…å®¹

```bash
uv run python main.py extract <æ–‡ä»¶.any> [-o <è¾“å‡ºæ–‡ä»¶>]

# ç¤ºä¾‹
uv run python main.py extract examples/test.any -o output.txt
```

å¦‚æœä¸æŒ‡å®šè¾“å‡ºæ–‡ä»¶åï¼Œå°†ä½¿ç”¨å…ƒæ•°æ®ä¸­çš„åŸå§‹æ–‡ä»¶åã€‚

## ç¤ºä¾‹

å®Œæ•´çš„ä½¿ç”¨æµç¨‹ï¼š

```bash
# 1. æ„å»º WASM æ¨¡å—
uv run python build_wasm.py

# 2. åˆ›å»º .any æ–‡ä»¶
uv run python main.py create examples/test_data.txt examples/simple.wasm \
    -o my_file.any \
    -n "My Document" \
    -d "Important document"

# 3. æŸ¥çœ‹æ–‡ä»¶ä¿¡æ¯
uv run python main.py info my_file.any

# 4. æå–æ–‡ä»¶å†…å®¹
uv run python main.py extract my_file.any -o restored.txt

# 5. éªŒè¯æ–‡ä»¶ä¸€è‡´æ€§
diff examples/test_data.txt restored.txt
```

## æ¶æ„è¯´æ˜

### æ ¸å¿ƒæ¨¡å—

- **any_format.py**: å®šä¹‰ .any æ–‡ä»¶æ ¼å¼ç»“æ„
  - `AnyFileHeader`: æ–‡ä»¶å¤´å®šä¹‰
  - `AnyFile`: å®Œæ•´æ–‡ä»¶ç»“æ„
  - åºåˆ—åŒ–/ååºåˆ—åŒ–åŠŸèƒ½

- **main.py**: ä¸»ç¨‹åº
  - `AnyFileRunner`: WASM è¿è¡Œå™¨
  - åˆ›å»ºã€æŸ¥çœ‹ã€æå–å‘½ä»¤å®ç°

- **build_wasm.py**: WASM æ„å»ºå·¥å…·
  - æ”¯æŒä» WAT è½¬æ¢ (éœ€è¦ wabt å·¥å…·)
  - å†…ç½®æœ€å° WASM æ¨¡å—ç”Ÿæˆ

### å®‰å…¨æ€§è€ƒè™‘

1. **æ²™ç®±æ‰§è¡Œ**: WASM åœ¨å—é™ç¯å¢ƒä¸­è¿è¡Œ
2. **å†…å­˜éš”ç¦»**: WASM æ¨¡å—æœ‰ç‹¬ç«‹çš„çº¿æ€§å†…å­˜
3. **å¯å®¡æŸ¥**: åœ¨æ‰§è¡Œå‰å¯ä»¥æ£€æŸ¥æ–‡ä»¶ä¿¡æ¯
4. **æ— ç³»ç»Ÿè°ƒç”¨**: WASM æ¨¡å—ä¸èƒ½ç›´æ¥è®¿é—®ç³»ç»Ÿèµ„æº

## æ‰©å±•æ–¹å‘

- [ ] æ”¯æŒå‹ç¼©ï¼ˆgzip, zstdï¼‰
- [ ] æ”¯æŒåŠ å¯†å’Œç­¾å
- [ ] æ”¯æŒå¤šæ–‡ä»¶æ‰“åŒ…
- [ ] æ›´ä¸°å¯Œçš„ WASM æ¥å£ï¼ˆåˆ—è¡¨ã€æœç´¢ç­‰ï¼‰
- [ ] GUI å·¥å…·
- [ ] æµè§ˆå™¨æ”¯æŒï¼ˆç›´æ¥åœ¨æµè§ˆå™¨ä¸­è¿è¡Œï¼‰

## æŠ€æœ¯æ ˆ

- **Python 3.13+**: ä¸»è¦ç¼–ç¨‹è¯­è¨€
- **wasmtime**: WebAssembly è¿è¡Œæ—¶
- **uv**: Python åŒ…ç®¡ç†å™¨

## è®¸å¯è¯

è§æ ¹ç›®å½• LICENSE æ–‡ä»¶

